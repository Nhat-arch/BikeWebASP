@model App.Models.ProductViewModel;
@{
    ViewData["title"] = "Thêm sản phẩm";
}
<div class="row">
    <div class="col-md-5">
        <div class="panel panel-default">
            <div class="panel-body">
                <form id="form1" asp-area="Admin" asp-controller="Product" asp-action="ProductAdd" method="post"
                    enctype="multipart/form-data">
                    <div>
                        @if (TempData["Success"] != null)
                        {
                            <div class="alert alert-success">
                                @TempData["Success"]
                            </div>
                        }
                    </div>
                    <div class="form-group">
                        <label class="control-label">Tên sản phẩm</label>
                        <input asp-for="Product.ProductName" class="form-control" />
                        <span asp-validation-for="Product.ProductName" class="text-danger"></span>
                        @if (TempData["TonTai"] != null)
                        {
                            <div class="alert alert-danger">
                                @TempData["TonTai"]
                            </div>
                        }
                    </div>
                    <div class="form-group">
                        <label class="control-label">Hãng sản xuất</label>
                        <select asp-for="Product.BrandId" class="form-control">
                            <option value="0">-- Chọn hãng sản xuất --</option>
                            @foreach (var b in Model.BrandList)
                            {
                                <option value="@b.BrandId">@b.BrandName</option>
                            }
                        </select>
                        <span asp-validation-for="Product.BrandId" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label class="control-label">Loại sản phẩm</label>
                        <select asp-for="Product.TypeId" class="form-control">
                            <option value="0">-- Chọn loại sản phẩm --</option>
                            @foreach (var t in Model.TypeList)
                            {
                                <option value="@t.TypeId">@t.TypeName</option>
                            }
                        </select>
                        <span asp-validation-for="Product.TypeId" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label class="control-label">Đơn giá</label>
                        <input asp-for="Product.ProductPrice" class="form-control" type="number" step="1000" />
                        <span asp-validation-for="Product.ProductPrice" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label class="control-label">Mô tả</label>
                        <textarea asp-for="Product.ProductDescription" class="form-control" rows="4"></textarea>
                        <span asp-validation-for="Product.ProductDescription" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label class="control-label">Hình ảnh</label>
                        <input type="hidden" id="imgUploadCount" name="imgUploadCount" value="1">
                        <div id="imgContainer">
                            <input style="margin-top: 4px;" id="imgUpload1" name="file[]" type="file"
                                accept=".jpg,.gif,.png">
                        </div>
                        @if (TempData["ImageError"] != null)
                        {
                            <span class="text-danger">@TempData["ImageError"]</span>
                        }
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">
                            <i class="fa fa-plus"></i> Thêm sản phẩm
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="panel panel-default">
            <div class="panel-body">
                <form id="form3" asp-area="Admin" asp-controller="Product" asp-action="BrandAdd" method="post">
                    <div class="form-group">
                        <label class="control-label">Thêm hãng sản xuất</label>
                        <input id="brandName" asp-for="Brand.BrandName" type="text" class="form-control" />
                        <span id="brandSuccess" asp-validation-for="Brand.BrandName" class="text-danger"></span>
                        @if (TempData["BrandSuccess"] != null)
                        {
                            <span class="text-success">
                                @TempData["BrandSuccess"]
                            </span>
                        }
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">
                            <i class="fa fa-plus"></i> Thêm
                        </button>
                    </div>
                </form>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-body">
                <form id="form2" asp-area="Admin" asp-controller="Product" asp-action="TypeAdd" method="post">
                    <div class="form-group">
                        <label class="control-label">Thêm loại sản phẩm </label>
                        <input id="typeName" asp-for="Type.TypeName" type="text" class="form-control" />
                        <span id="typeSuccess" asp-validation-for="Type.TypeName" class="text-danger"></span>
                        @if (TempData["TypeSuccess"] != null)
                        {
                            <span class="text-success">
                                @TempData["TypeSuccess"]
                            </span>
                        }
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">
                            <i class="fa fa-plus"></i> Thêm
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.getElementById('imgUpload1').oninput = function () {
            var container = document.getElementById('imgContainer');
            var imgUploadCount = document.getElementById('imgUploadCount');
            var count = parseInt(imgUploadCount.value);
            //--Tạo file input mới
            var newInput = document.createElement('input');
            newInput.id = 'imgUpload' + (count + 1);
            newInput.name = 'file[]';
            newInput.type = 'file';
            newInput.accept = '.jpg,.gif,.png';
            newInput.style.marginTop = '4px';
            //--*
            //--Tạo nút xóa
            var remove = document.createElement('button');
            remove.innerHTML = 'X';
            remove.style.float = 'right';
            remove.onclick = function () {
                container.removeChild(document.getElementById('imgUpload' + count));
                container.removeChild(remove);
            };
            //--*
            container.prepend(newInput, remove);
            //--Điều chỉnh cho lần tạo tiếp theo
            imgUploadCount.value = count + 1;
            newInput.oninput = this.oninput;
            this.oninput = null;
            //--
        }
    </script>
}